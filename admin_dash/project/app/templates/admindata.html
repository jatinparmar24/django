{% extends "base.html" %}

{% block title %} Admin dashboard{% endblock %}

{% block content %}


  <div class="admin_tab">
  <a href="{% url 'add_emp' %}?show_form=1" class="create-employee-link">Create Employee</a> <br>
  <a href="{% url 'show_all_emp' %}" class="create-employee-link">Show Employee</a> <br>
</div>

<!-- Form Section -->
{% if show_form %}
  <div class="form-container">
    <form method="post" enctype="multipart/form-data" action="{% url 'add_emp' %}">
      {% csrf_token %}

      <label for="name">Name:</label>
      <input type="text" name="name" required><br><br>

      <label for="phone">Phone:</label>
      <input type="tel" name="phone" pattern="[0-9]{10}" required><br><br>

      <label for="dob">DOB:</label>
      <input type="date" name="dob" min="1990-01-01" max="2020-01-01" required><br><br>

      <label for="email">Email:</label>
      <input type="email" name="email" required><br><br>

      <label for="password">Password:</label>
      <input type="password" name="password" required><br><br>

      <label for="profile-pic">Profile Picture:</label>
      <input type="file" name="profile-pic" accept=".jpg,.jpeg,.png"><br><br>

      <input type="submit" value="Register">
    </form>
  </div>
{% endif %}

<!-- Employee Table Section -->
{% if show_all %}
  <table border="1">
    <tr>
      <th>S.NO</th>
      <th>Name</th>
      <th>Contact</th>
      <th>DOB</th>
      <th>Email</th>
      <th>Password</th>
      <th>Profile</th>
      <th>Edit</th>
      <th>Delete</th>
    </tr>

    {% for i in emp_data %}
      <tr>
        <td>{{ forloop.counter }}</td>
        <td>{{ i.emp_name }}</td>
        <td>{{ i.emp_contact }}</td>
        <td>{{ i.emp_dob }}</td>
        <td>{{ i.emp_email }}</td>
        <td>{{ i.emp_pass}}</td>
        <td>
          {% if i.emp_image %}
            <img src="{{ i.emp_image.url }}" alt="Profile" width="50" height="50" style="object-fit: cover; border-radius: 50%;">
          {% else %}
            No Image
          {% endif %}
        </td>
        <td>
          <a href="{% url 'edit_emp' i.id %}">Edit</a> 
        </td>
        <td>
          <a href="{% url 'delete_employee' i.id %}" onclick="return confirm('Are you sure you want to delete this employee?');">Delete</a>
        </td>
      </tr>
    {% endfor %}
  </table>
{% endif %}

{% if edit_employee %}
<form action="{% url 'edit_emp' edit_employee.id %}" method="post" enctype="multipart/form-data">
  {% csrf_token %}

  <input type="text" name="name" value="{{ edit_employee.emp_name }}">
  <input type="text" name="contact" value="{{ edit_employee.emp_contact }}">
  <input type="date" name="dob" value="{{ edit_employee.emp_dob|date:'Y-m-d' }}">
  <input type="email" name="email" value="{{ edit_employee.emp_email }}">
  <input type="text" name="pass" value="{{ edit_employee.emp_pass }}">

  {% if edit_employee.emp_image %}
    <img src="{{ edit_employee.emp_image.url }}" alt="Current Image" width="50" style="border-radius: 10px; object-fit: cover;">
  {% else %}
    <p>No profile image uploaded.</p>
  {% endif %}

  <input type="file" name="image">

  <input type="submit" value="Update">
</form>


{% endif %}

    


{% endblock %}